<!DOCTYPE html>

<html>
    <head>
       <meta charset="utf-8">
		<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
		<link rel="stylesheet" type="text/css" href="css/ionic.min.css" />
		<style>
		html,body{
		width:100%;
		height:100%;
		margin:0px;
		pading:0px;
		overflow:hide;
		position: fixed;
		background-color:#444;
		}
		.fxd{
		position: fixed;
		}
		</style>
        <script type="text/javascript" src="js/ionic.bundle.min.js"></script>
        <script type="text/javascript" src="js/NgDicomViewer.js"></script>
        <script type="text/javascript" src="js/Explorer.js"></script>
        <script type="text/javascript" src="js/openjpeg.js"></script>
        <script type="text/javascript" src="js/ng-cordova.min.js"></script>
        <script type="text/javascript">
		angular.module('dvh', ['ionic','ngdicomviewer','ngCordova'])
		 .controller('ctrl', function($scope, $cordovaFile,$ionicPlatform,$ionicSideMenuDelegate,$rootScope) {
			
			$scope.explore =false;
			$scope.showTools = true;
			$scope.urll=false;
			$scope.dirs =[];
			$scope.files =[];
			var explorer =new Explorer();
			var callBack = function(dirs,files,file)
			{
			try{
				if(dirs && files){
				$scope.$apply(function(){
					$scope.dirs =dirs;
					$scope.files =files;
				});
				}
				if(file)
				{
					$scope.$apply(function(){
						//alert(file.name);
					try{
						$scope.loadFile(file);
						$scope.explore =false;
						$scope.showTools = true;
						}
						catch(e)
						{
							alert(e.message);
						}
					});
				}
				}
				catch(e)
				{
				alert("Update erroe:"+e.message)
				}
			}.bind(this);
			explorer.UpdateScope = callBack;
			$ionicPlatform.ready(function() {
			try{
				explorer.getFileSystem();
				}
				catch(e)
				{
				alert(e.message);
				}
			});
			$rootScope.OpenSelectedItem = function(name,type)
			{
				//alert(name+"/"+type + "/"+ explorer.getActiveItem)
				explorer.getActiveItem(name, type);
			//	alert(name+"/"+type)
				explorer.openItem(explorer.activeItemType);
			}
			$scope.back = function()
			{
				if( explorer.parentDir != null ) 
				explorer.listDir(explorer.parentDir);
			}
			$scope.toolActivate = function(name,type)
			{
				//alert(name+"/"+type + "/"+ explorer.getActiveItem)
				$scope.SelectedMouseTool=val;
			}			
			});
			
		</script>
        <script type="text/javascript" src="cordova.js"></script>
    
  <title>DICOM VIEWER HTML5</title>
    </head>
    <body ng-app="dvh" ng-controller="ctrl" >
	
		<div class="bar bar-dark fxd">
			<div class="buttons">
				<button class="button" ng-click="explore = true; showTools = false;urll=false ">explore</button>
				<button class="button" ng-click="showTools = true; explore =false ;urll=false">Tools</button>
			</div>
			<h1 class="title" >DVH</h1>
			<div class="buttons">
				<button class="button" ng-click="showTools = false; explore = false;urll=true;" >Open</button>
			</div>
			
		</div>

		<div ng-show ="showTools" class="row has-header " style="background-color:black;margin-top:43px">
			  <div class="col "><img src="icons/cir.png" ng-click="SelectedMouseTool='circle';"/></div>
			  <div class="col "><img src="icons/line.png" ng-click="SelectedMouseTool='line';"/></div>
			  <div class="col "><img src="icons/rect.png" ng-click="SelectedMouseTool='rectangular';"/></div>
			  <div class="col "><img src="icons/ele.png" ng-click="SelectedMouseTool='ellipse';"/></div>
			  <div class="col "><img src="icons/wl.png" ng-click="SelectedMouseTool='WindowLevel';"/></div>
			  <div class="col "><img src="icons/plane.png" ng-click="SelectedButtonTool='plain';"/></div>
			  <div class="col "><img src="icons/Ivt.png" ng-click="SelectedButtonTool='invplain';"/></div>
		</div>
		<div ng-show ="showTools" class="row " style="background-color:black">
			  <div class="col "><img src="icons/hot.png" ng-click="SelectedButtonTool='hot';"/></div>
			  <div class="col "><img src="icons/rbow.png" ng-click="SelectedButtonTool='rainbow';"/></div>
			  <div class="col "><img src="icons/snr.png" ng-click="SelectedButtonTool='sharpen';"/></div>
			  <div class="col "><img src="icons/ed.png" ng-click="SelectedButtonTool='sobel';"/></div>
			  <div class="col "><img src="icons/rset.png" ng-click="SelectedButtonTool='reset image';"/></div>
			  <div class="col ">
				<img src="icons/clrann.png" ng-click="SelectedButtonTool='clearAnnotation';"/>
			  </div>
			  <div class="col "><img src="icons/clr.png" ng-click="SelectedButtonTool='clear'"/></div>
		</div>
		<div ng-show="urll "class="row " style="background-color:black;margin-top:43px;">
			  <div class="col col-90 buttons">
			  <input type="text"  id="file" style="padding:3px;overflow:hidden" value="http://x.babymri.org/?53320924&.dcm" />
			  
			  </div>
			  <div class="col col-10 buttons"><button class="button button-royal" style="line-height:32px;min-height:0px;" id="urlbtn" >Open</button></div>
		</div>
			<!-- <div ng-show ="showTools" class="row " style="background-color:black;color:white; vertical-align:middle">
			<button  style="color:white;margin:0px;border:0px;background-color:black;cursor:default" >ZOOM [.1-4]: </button>
			<input type="text"  id="file" style="width:25px" ng-model="ZoomCss" />
			
			</div> -->
			<div ng-hide="explore" id="dicomContainer" class = "row " style="overflow:none;height:65%;position:absolute;padding-top:10px;-webkit-transform-origin: 0 0;" ng-style="{zoom :ZoomCss }">
						
				<div style="margin-left: auto;margin-right: auto;display: table;height: 100%;">
				<div style="margin-left: auto;margin-right: auto;display: table;height: 100%;">
					<div style="display: table-cell;vertical-align: middle;margin-bottom:15px">
						<dicomviewer class ="dicom" fileutilityid ="" urllistid="file" urlopenbtnid="urlbtn" style=""></dicomviewer>
					</div> 
				</div>
			</div>
			</div>
					
		

		
			<div  ng-show="explore" class="button button-dark" ng-click="back();" style="margin:5px;margin-top:48px"> back </div>
			<div  ng-show="explore" class = "list" style="padding-top: 15px;width:100%;overflow-y:auto;height:70%;display:block;position:absolute">
				<div class="item item-divider">
				 Folders:
				 </div>
				<div class="button" ng-repeat="o in dirs" ng-click="OpenSelectedItem(o.name,'d')" style="width:49%;float:left">{{o.name}}</div>
				<div class="item item-divider">
				 Files
				</div>
				<div class="button" ng-repeat="i in files" ng-click="OpenSelectedItem(i.name,'f')" style="width:49%;float:left">{{i.name}}</div>
			</div>
			
			
		<!-- <div  class = "row " style="margin-top:43px;overflow:auto;height:100%;width:100%;position:absolute" ></div> -->


    </body>
</html>
